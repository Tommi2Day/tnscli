version: '3.8'
name: tnscli
services:
  oracle:
    image: 'gvenzl/oracle-free:23.26.0-slim'
    restart: "no"
    environment:
      - 'ORACLE_PASSWORD=FREE-Manager23'
    ports:
      - '21521:1521'
    volumes:
      - "./oracle-db:/container-entrypoint-initdb.d"

  ldap:
    image: "${VENDOR_IMAGE_PREFIX}docker.io/cleanstart/openldap:2.6.10"
    restart: "no"
    hostname: "ldap.oracle.local"
    ports:
      - '1389:389'
      - '1636:636'
    volumes:
      - "./oracle-ldap/ldif:/ldif:ro"
      - "./oracle-ldap/certs:/certs:ro"
      - "./oracle-ldap/etc/slapd.conf:/etc/openldap/slapd.conf:ro"

  dns:
    image: "tnscli-dns:latest"
    build:
      context: oracle-dns
      dockerfile: Dockerfile
      args:
        VENDOR_IMAGE_PREFIX: ${VENDOR_IMAGE_PREFIX}
        BIND9_VERSION: "9.20"
    ports:
      - '9055:9055'
    restart: "no"
    hostname: "ns1.rac.lan"
    networks:
      - dns
      - default
networks:
    dns:
        driver: bridge
